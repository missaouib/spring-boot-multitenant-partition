# Define a custom log format that includes the tenant ID
LogFormat "%{TENANT_ID}e %h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" custom_with_tenant

# Set environment variable TENANT_ID based on the hostname
SetEnvIf Host "(.+\.)designre\.io$" TENANT_ID=$1

# Define a virtual host that matches the tenant subdomains
<VirtualHost *:80>
    ServerAlias *.designre.io
    DocumentRoot /var/www/$1

    # Use the custom log format for access logs
    CustomLog /var/log/httpd/access.log custom_with_tenant

    # Error log location
    ErrorLog /var/log/httpd/error.log

    <Location />
        ProxyPass http://tenant:8080/
        ProxyPassReverse http://tenant:8080/

        # Add additional proxy configuration if needed
        ProxyPreserveHost On
        RequestHeader set X-TENANT-ID %{TENANT_ID}e
    </Location>
</VirtualHost>
